<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-6947936742546167",
          enable_page_level_ads: true
     });
</script>
<title>Ding: User Manual</title>
<meta name="Author" content="Marcelo Gornstein"/>
<meta name="Keywords" content="Ding is a free, open source, lightweight, php framework with several capabilities from the java enterprise world, like bean container, jsr 250 and jsr 330 annotations, inversion of control (IoC), dependency injection (di), aspect oriented programming (), mvc, and several other tools. Much like like symfony, bucket, pico, yadif, phemto, lion, and pimple."/>
<meta name="description" content="Ding is a free, open source, lightweight, php framework with several capabilities from the java enterprise world, like bean container, jsr 250 and jsr 330 annotations, inversion of control (IoC), dependency injection (di), aspect oriented programming (), mvc, and several other tools. Much like like symfony, bucket, pico, yadif, phemto, lion, and pimple."/>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../images/favicon.ico" title="favicon" />
<link rel="stylesheet" href="../css/main.css" type="text/css" media="all" />
<link href='../dphighlighter/SyntaxHighlighter.css' rel='stylesheet' type='text/css' />
<!--[if IE]>
<link type="text/css" rel="stylesheet" media="screen" href="../css/fix-ie.css" />
<![endif]-->
<!--[if IE 6]>
<script type="text/javascript" src="../js/fix-png.js"></script>
<![endif]-->
<script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script>
<script type="text/javascript" src="../js/lib/jquery-core.js"></script>
<script type="text/javascript" src="../js/main.js"></script>
</head>
<body>
<div id="wrapper">
  <div id="top">
    <!-- <a class="logo" href="index.html">Marcelo G</a> -->
    <ul id="nav">
      <li><a href="/index.html"><span>Home</span></a></li>
      <!-- <li><a href="../about.html"><span>About</span></a></li> -->
      <li><a href="/articles/articles.html"><span>Articles</span></a></li>
      <li class="active"><a href="/software.html"><span>Software</span></a></li>
      <li><a href="mailto:marcelog@gmail.com"><span>Contact</span></a></li>
    </ul>
  </div>
  <div class="header">
    <div class="line">
      <h1>Software</h1>
      <div class="social-network">
       <a href="mailto:marcelog@gmail.com" class="icon-email" title="Email">Email</a>
       <g:plusone></g:plusone>
      </div>
    </div>
    <div class="breadcrumb">You are here &nbsp;&raquo;&nbsp; <a href="/index.html">Home Page</a>  &nbsp;&raquo;&nbsp;  <a href="/software.html">Software</a>  &nbsp;&raquo;&nbsp;  Ding</div>
  </div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- blog2 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-6947936742546167"
     data-ad-slot="2769853059"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
  <div class="main-outer">
    <div class="main-inner">
        <div class="main">
        <div class="line">
          <div id="content">
            <div class="mod simple">
              <span class="top"><span class="tl"></span><span class="tr"></span></span>
              <div class="inner set-height-1">
                <h2>Ding: Dependency Injection in your PHP Applications</h2>
<a href="https://twitter.com/share" class="twitter-share-button" data-via="mgornstein" data-size="large" data-related="mgornstein">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

                <ul class="tab-title">
                    <li><a href="/Ding/index.html">About</a></li>
                    <li><a href="install.html">Installation</a></li>
                    <li><a href="api.html">API</a></li>
                    <li class="active"><a href="toc.html">Manual</a></li>
                    <li><a href="metrics.html">Metrics</a></li>
                    <li><a href="examples.html">Examples</a></li>
                </ul>
                <div id="tab-content-4" class="tab-content tab-content-extra">
                    <ol class="number-list">
    <li><a href="#about">About this manual</a></li>
    <li><a href="#ioc">The beans, the container, Inversion Of Control, and Dependency Injection</a></li>
    <li><a href="#events">Events and event driven programming support</a></li>
    <li><a href="#resources">Using Resources</a></li>
    <li><a href="#i18n">Internationalization (i18n) support</a></li>
    <li><a href="#aop">Aspect Oriented Programming</a></li>
    <li><a href="#config">Configuring the container</a></li>
    <li><a href="#mvc">The MVC Implementation</a></li>
    <li><a href="#helper-syslog">The Syslog helper</a></li>
    <li><a href="#helper-pami">The PAMI helper</a></li>
    <li><a href="#helper-pagi">The PAGI helper</a></li>
    <li><a href="#helper-tcpclient">The TCP Client helper</a></li>
    <li><a href="#helper-tcpserver">The TCP Server helper</a></li>
                  </ol>
                    <a name="about" id="about"></a>
                  <div class="line">
                        <h3>1. About this manual</h3>
                  </div>
                  <div class="hr-1"><hr /></div>
<p>
This manual, its samples, and Ding itself are not inteded to be an introduction or
tutorial about dependency injection, inversion of control, aspect oriented programming,
php, or anything that is not Ding itself. If you are not familiar with these concepts,
you may still use Ding (since its really easy to do so).
</p>
<p>
However, you are encouraged to
read about these subjects, just search the web and you will find a lot of good articles,
books, and tutorials. Also, having some knowledge or experience using the Spring framework,
Seasar, or Sean is not required, but useful when using Ding.
</p>
                    <a href="#" class="next-link"><strong>Back</strong></a>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- blog1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-6947936742546167"
     data-ad-slot="6142121850"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>                    <a name="ioc" id="ioc"></a>
                  <div class="line">
                        <h3>2. The beans, the container, Inversion Of Control, and Dependency Injection</h3>
                    <!-- <a href="#" class="next-link"><strong>Next</strong></a> -->
                  </div>
                  <div class="hr-1"><hr /></div>
<H4>Beans</H4>
<p>
A Bean is just an object. We call it bean because this particular object obeys some
rules and this rules and the bean's lifecycle are managed entirely by what is called
a container.
</p>
<p>
In the java world, a bean is a POJO (Plan Old Java Object), meaning that
virtually any concrete class definition is a bean. Since the latter also
applies in the php world, we should say that a bean is a "POPO"
(Plain Old PHP Object).
</p>
<H4>Scopes</H4>
<p>
The scope of the bean defines its lifecycle (when it is created and when should
be destroyed). The container provides the following options as scopes:
</p>
<p>
<ul>
  <li><u>Singleton:</u>The container will have a single instance for the bean
  (lazy created), and will return this instance every time this bean is
  asked for.
  </li>
  <li><u>Prototype:</u>The container will return a new instance every time
  this bean is asked for.
  </li>
</ul>
</p>
<H4>Bean metadata</H4>
<p>
For each managed bean by the container, exists a bean definition, which
composes all the metadata needed by the container and its extensions to
actually create and modify the bean's behavior.
</p>
<p>
This data is generated, and
modified by "Providers". Providers are registered in the container. Currently, Ding supports 3
different providers: "xml", "yaml", and "annotations".
</p>
<p>
The first two read and parse a xml/yaml
file (normally called beans.xml/beans.yaml) and the latter generates metadata from the annotations
found in each of the classes of the project and their methods.
</p>
<p>
 Any number of providers can be used at any
given time, they are supposed to complement each one's metadata. So for example you may
use an annotation in your class at the same time that is declared (with the same or
different features or properties) in the beans.xml/beans.yaml file.
</p>
<p>
This metadata includes:

<ul>
  <li><u>Properties:</u>Optional. Properties have also its own metadata (see below).</li>
  <li><u>Constructor arguments:</u>Optional. They almost identical to properties, and have
  their own metadata (see below).</li>
  <li><u>Aspects:</u>Optional. All aspects applied to this bean. Aspects have their own
  metadata (see below).</li>
  <li><u>Name:</u>Mandatory. The bean's name.</li>
  <li><u>Class:</u>Mandatory. The bean's full class name (including namespace, like A\B\Foo.</li>
  <li><u>Scope:</u>Mandatory. The bean's scope. This informs the container how to handle
  the lifecycle of this bean. The scope is singleton by default.</li>
  <li><u>Annotations:</u>Optional. All class-level annotations. Annotations have their
  own metadata. (see below).</li>
  <li><u>Init method:</u>Optional. You may declare an optional method to call right after the bean
  is constructed and its properties injected so you can initialize internal stuff.</li>
  <li><u>Shutdown method</u>Optional. You may declare an optional method to call when the container
  is destroyed, so you can cleanup internal stuff.</li>
  <li><u>Method annotations:</u>Optional. All method-level annotations.</li>
  <li><u>Method injections:</u>Optional. All methods that must return a prototype scoped bean (dependency).</li>
  <li><u>Bean dependencies:</u>Optional. Which beans need to be created before creating
  this bean. This has nothing to do with properties that reference other beans
  (those are resolved when creating each property), but with indirect
  dependencies (for instance, bean A depends on bean B which in turns depends
  on bean C, so in order to create bean A, we need to create C and B).</li>
  <li><u>Factory Method:</u>Optional. If specified, will call a static method of Factory
  Class, a method of Factory Method, or a static method of the bean class in
  order to create the bean (instead of using the constructor).</li>
  <li><u>Factory Class:</u>Optional. If specified, informs the container to call
  a static method (see Factory Method) of the given class to create the bean
  instead of using the constructor.</li>
  <li><u>Factory Bean:</u>Optional. Same as factory class, but will use a method for
  the given bean.</li>
  <li><u>Abstract:</u>Since 1.1.0. False by default. Specifies a bean as concrete or abstract. Abstract beans cant be instantiated.</li>
  <li><u>Parent:</u>Since 1.1.0. Optional. The name of parent bean, if any.</li>
  <li><u>Aliases:</u>Since 1.1.2. Optional. An array of strings, with the aliases known for this bean.</li>
</ul>
</p>
<H4>Examples:</H4>
<p>
<u>Generic bean definition (annotations provider)</u>
</p>
<p>
If you're interested in using annotations, take a look at the following articles:
<ul>
<li><a href="http://marcelog.github.com/articles/ding_component_bean_annotations.html">For annotations to define components</a></li>
<li><a href="http://marcelog.github.com/articles/ding_component_bean_annotations_di_dependency_injection.html">For DI annotations</a></li>
</ul>
</p>
<p>
This is pretty much the same as Java Configuration. You can define a class and
annotate it with @Configuration. All methods of this class (or classes) annotated
themselves with @Bean will became a source for bean definitions.
</p>
<p>
@Configuration classes become factory beans. So, a class annotated with
@Configuration, having a method called "someBean" which is in turn annotated
with @Bean, will become the factory bean and factory method for the bean named
"someBean". See docs/examples/ConfigurationAnnotation. (JSR-330)
</p>
<p>
@Bean can also be used inside methods of @Component's.
</p>
<p>
This behavior can be overriden if you use the argument name= in the @Bean
annotation, like:<br/>
<br/>
@Bean(name=someOtherName)<br/><br/>
The string "someOtherName" is now the final name of the bean (although the method
is still used as the factory method). (JSR-330)
</p>
<p>
For every of the @Bean annotated methods, you should also specify:
</p>
<p>
@Scope(value=xxx) Where xxx is one of prototype or singleton.
</p>
<p>
@Singleton same as @Scope(value="singleton"). This is the default scope for beans.
</p>
<p>
@Prototype same as @Scope(value="prototype")
</p>
<p>
@InitMethod(method=xxx) Where xxx is the method to call to initialize the bean.
</p>
<p>
@PostConstruct: Using this annotation in a method is equivalent to @InitMethod(method="xxx")
</p>
<p>
@DestroyMethod(method=xxx) Where xxx is the method to call to destroy the bean on
container shutdown.
</p>
<p>
@PreDestroy: Using this annotation in a method is equivalent to @DestroyMethod(method="xxx")
</p>
<p>
@Component: Ding also supports @Component annotation. If you annotate a class with this
annotation, it will become a bean without needing to specify a @Configuration class. Example:
</p>
<p>
@Named: At the class level, this annotation is an alias for @Component.
</p>
<pre name="code" class="php">
/**
 * This is our bean.
 * @Component(name=myBean)
 * @InitMethod(method=init)
 * @Scope(value=singleton)
 */
class MyBean
{
    /**
     * @Resource
     */
    private $myDependency;

    public function init()
    {
        echo "init\n";
    }
    /**
     * @PreDestroy
     */
    public function destroy()
    {
        echo "destroy\n";
    }
    public function __construct()
    {

    }
}

/**
 * @Component(name=myDependency)
 * @Singleton
 */
class MyDependency
{

}
</pre>
<p>
The full example is available <a href="https://github.com/marcelog/Ding/tree/master/docs/examples/ComponentAnnotation">here</a>.
</p>
<p>
Since version 1.1.2, Ding supports bean aliasing, so you can give multiple names for a @Component, like so:
</p>
<pre name="code" class="php">
/**
 * @Component(name={name1, name2, name3})
 */
class MyBean
{
...
}
</pre>
<p>
The full example is available <a href="https://github.com/marcelog/Ding/tree/master/docs/examples/alias-annotations">here</a>.
</p>
<p>
Since 1.3.8: You can also declare beans inside methods of components:
</p>
<pre name="code" class="php">
/**
 * @Component(name={name1, name2, name3})
 */
class MyBean
{
    /**
     * @Bean
     */
    public function myBean()
    {
        return new ABean();
    }
}
</pre>
<p>
@Required Use this one in your setter methods (i.e: setSomething()) and this
will tell the container to throw an exception if this property isnt configured
when instantiating the bean. (JSR-330)
</p>
<p>
@Resource: Use it in setters AND/OR properties to resolve the injected dependency by name. So
for example, the method setDependency() will resolve to a bean named "dependency".
(JSR-250).
</p>
<p>
Since 1.5.0: @Resource can also accept an optional name to indicate the name of the bean to be
injected:
</p>
<pre name="code" class="php">
/**
 * @Component
 */
class MyBean
{
    /**
     * @Resource(name="aBeanName")
     */
    protected $property;

    /**
     * @Resource(name="aBeanName")
     */
    public function anotherDependency($value)
    {
    }
}
</pre>

<pre name="code" class="php">
/**
 * @Configuration
 */
class SomeBeanProviderClass
{
    /**
     * @Resource
     */
    protected $dependency;

    /**
     * @Bean
     * @Scope(value='singleton')
     * @InitMethod(method=aMethod)
     * @DestroyMethod(method=bMethod)
     */
    public function someBean()
    {
        $ret = new MyBean();
        $ret->setSomeProperty('hello world');
        return $ret;
    }
    /**
     * @Bean(name=anOverridenName)
     * @Scope(value='singleton')
     * @InitMethod(method=aMethod)
     * @DestroyMethod(method=bMethod)
     */
    public function aNormalMethod()
    {
        $ret = new MyBean();
        $ret->setSomeProperty('hello world');
        return $ret;
    }

    /**
     * @Bean
     * @Value(value=${aProperty})
     * @Value(value=${anotherProperty})
     */
    public function aBeanWithConstructorArguments($arg1, $arg2)
    {
        return new Something($arg1, $arg2);
    }
}
</pre>
<p>
Notice how to inject constructor arguments for beans that come from a @Configuration
class. The bean named "aBeanWithConstructorArguments" has been annotated with 2
constructor arguments (the @Value annotations), specified in order of appearance.
</p>
<p>
DI between configuration classes can also be achieved. I.e: annotate a property
of a configuration class with @Resource. This will tell the container to look for
a bean that is named like the annotated property. This bean can be provided in another
@Configuration annotated class. See docs/examples/PropertiesAnnotations.
</p>
<p>
Since version 1.1.2, you can use bean aliasing with @Bean. Example:
</p>
<pre name="code" class="php">
/**
 * @Configuration
 */
class SomeBeanProviderClass
{
    /**
     * @Bean(name={name1, name2, name3})
     */
    public function someBean()
    {
    ...
    }
}
</pre>
<p>
The full example is available <a href="https://github.com/marcelog/Ding/tree/master/docs/examples/alias-annotations">here</a>.
</p>
<p>
<u>Generic bean definition (xml and yaml providers)</u>
</p>
<p>
The examples here are based on the xml provider. If you want to take a look at the
yaml syntax (fully compatible and almost equal to the xml syntax), please take a look at
<a href="https://github.com/marcelog/Ding/tree/master/docs/examples/yaml">the yaml example</a>
</p>
<p>
For a prototype bean (multiple instances allowed):
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype"/&gt;
&lt;/beans&gt;
</pre>

<p>
For a singleton bean (only one instance allowed):
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="singleton"/&gt;
&lt;/beans&gt;
</pre>
<p>
All options in the above examples are *MANDATORY*. What follows are examples with
optional arguments:
</p>

<p>
This one will first create aBean, bBean, cBean before creating "beanName":
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype" depends-on="aBean, bBean, cBean"/&gt;
&lt;/beans&gt;
</pre>
<p>
This one will call A\B\C::getInstance() (static method) in order to get a bean:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype" factory-method="getInstance"/&gt;
&lt;/beans&gt;
</pre>

<p>
This one will first create "anotherBean" and then call anotherBean->getInstance() (instance method) in order to get the other bean:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype" factory-bean="anotherBean" factory-method="getInstance"/&gt;
&lt;/beans&gt;
</pre>

<p>
This one will call init() as soon as the bean is created and all its properties are injected but before returning the instance to the caller:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype" init-method="init"/&gt;
&lt;/beans&gt;
</pre>


<p>
This one will call destroy() when the container is destroyed:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype" destroy-method="destroy"/&gt;
&lt;/beans&gt;
</pre>
<p>
Since version 1.1.2, Ding supports bean aliasing, so you can give multiple names for a bean. The id
property specifies *the* name of the bean, while the name property specifies the aliases. Example:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" name="alias1, alias2, alias3"/&gt;
&lt;/beans&gt;
</pre>
<p>
<ul>
<li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/alias-xml">XML</a> provider example</li>
<li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/alias-yaml">YAML</a> provider example</li>
</ul>
<H4>Constructor arguments types and metadata</H4>
<p>
The constructor arguments for a bean behave exactly like properties. See the
sections below.
 </p>
<H4>Properties types</H4>
<ul>
  <li><u>Array:</u>An array has a key (mandatory) and 1 value per key (which in
  turn can be of any type, so you can have arrays inside arrays, etc).</li>
  <li><u>Scalar value:</u>A final value, like a string, an integer, etc.</li>
  <li><u>Bean reference:</u>A string containing the name of another bean defined
  in the container.</li>
  <li><u>Code:</u>PHP code to be eval()'uated by the container.</li>
</ul>

<H4>Properties metadata</H4>
<ul>
  <li><u>Name:</u>The name of the property. The name is important for setter
injection, i.e: a property called 'name' will be injected calling setName()</li>
  <li><u>Type:</u>See above for properties types</li>
  <li><u>Value:</u>The actual value, whatever the type. The value can also be
  a string like ${some.value}, which resembles java properties. The container will
  notice this and will put the correct value (assuming you passed the right value
  when instantiating the container). Special values like false, true, and null
  are specified explicitely (see below).</li>
</ul>
<p>
The PropertyDriver, is responsible for getting the bean "PropertiesHolder", where
any number of php ini files can be specified from where to read more properties. It will
then register these properties in the container.
Please read <a href="#config">this</a> for the details.
</p>
<H4>Examples:</H4>
<p>
Define a scalar property:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype"&gt;
        &lt;property name="someProperty"&gt;
            &lt;value&gt;aValue&lt;/value&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<p>
Define a scalar property with special values like false, true, and null:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype"&gt;
        &lt;property name="someProperty1"&gt;
            &lt;null/&gt;
        &lt;/property&gt;
        &lt;property name="someProperty2"&gt;
            &lt;true/&gt;
        &lt;/property&gt;
        &lt;property name="someProperty3"&gt;
            &lt;false/&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<p>
Define a scalar constructor argument:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype"&gt;
        &lt;constructor-arg&gt;
            &lt;value&gt;aValue&lt;/value&gt;
        &lt;/constructor-arg&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<p>
Mixing both:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype"&gt;
        &lt;constructor-arg&gt;
            &lt;value&gt;aValue&lt;/value&gt;
        &lt;/constructor-arg&gt;
        &lt;property name="someProperty"&gt;
            &lt;value&gt;aValue&lt;/value&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<p>
The following examples also apply to constructor arguments
</p>
<p>
Define a scalar property with a container property:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype"&gt;
        &lt;property name="someProperty"&gt;
            &lt;value&gt;${some.value}&lt;/value&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<p>
Define a reference to another bean as a property:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype"&gt;
        &lt;property name="someProperty"&gt;
            &lt;ref bean="otherBean"/&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<p>
Define a property as code to be evaluated:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype"&gt;
        &lt;property name="someProperty"&gt;
            &lt;eval&gt;&lt;![CDATA[ return "Some evaluated code"; ]]>&lt;/eval&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<p>
Define an array as a property:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype"&gt;
        &lt;property name="someProperty"&gt;
            &lt;array&gt;
                &lt;entry key="0"&gt;&lt;ref bean="otherBean"/&gt;&lt;/entry&gt;
                &lt;entry key="1"&gt;&lt;value&gt;aValue&lt;/value&gt;&lt;/entry&gt;
                &lt;entry key="2"&gt;&lt;eval&gt;&lt;![CDATA[ return "Some evaluated code"; ]]>&lt;/eval&gt;&lt;/entry&gt;
                &lt;entry key="3"&gt;&lt;array&gt;&lt;entry key="other"&gt;&lt;value&gt;${aValue}&lt;/value&gt;&lt;/entry&gt;&lt;/array&gt;&lt;/entry&gt;
            &lt;/array&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<p>
Array keys are optional, so you can also do this:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype"&gt;
        &lt;property name="someProperty"&gt;
            &lt;array&gt;
                &lt;entry&lt;ref bean="otherBean"/&gt;&lt;/entry&gt;
                &lt;entry&lt;value&gt;aValue&lt;/value&gt;&lt;/entry&gt;
                &lt;entry&lt;eval&gt;&lt;![CDATA[ return "Some evaluated code"; ]]>&lt;/eval&gt;&lt;/entry&gt;
                &lt;entry&lt;array&gt;&lt;entry key="other"&gt;&lt;value&gt;${aValue}&lt;/value&gt;&lt;/entry&gt;&lt;/array&gt;&lt;/entry&gt;
            &lt;/array&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<p>
You can also use properties to declare bean classes, so you can choose/switch implementation
at real time:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="${aCustomImplementation}"/&gt;
&lt;/beans&gt;
</pre>
<p>
When using annotations, you can also inject the container properties into the bean properties:
</p>
<pre name="code" class="php">
/**
 * @Component(name="myBeanName")
 */
class MyBean
{
    /**
     * @Value(value="${user.property}/asd")
     */
    protected $someProperty;
}
</pre>
<p>
Suppose we defined "user.property" to be "myValue", then in this example, the property
"someProperty" will be injected with "myValue/asd".
</p>
<H4>Using names in constructor arguments</H4>
<p>
Since 1.3.6 its possible to specify a name for a constructor argument, like:
</p>
<pre name="code" class="php">
/**
 * Example with @Component beans.
 * @Component
 */
class MyComponent
{
    /**
     * @Value(name="arg1", value=${arg1}"
     * @Value(name="arg2", value=${arg2}"
     * @Value(name="arg3", value=${arg3}"
     */
    public function __construct($arg1, $arg2, $arg3)
    {
    }
}

/**
 * Example with @Bean methods.
 * @Configuration
 */
class MyConfiguration
{
    /**
     * @Value(name="arg1", value=${arg1}"
     * @Value(name="arg2", value=${arg2}"
     * @Value(name="arg3", value=${arg3}"
     */
    public function myBean($arg1, $arg2, $arg3)
    {
        return new MyComponent($arg1, $arg2, $arg3)
    }
}
</pre>
<p>
In Xml:
</p>
<pre name="code" class="xml">
&lt;bean id="myBean" class="MyComponent"&gt;
  &lt;constructor-arg name="arg1"&gt;&lt;value&gt;${arg1}&lt;/value&gt;&lt;/constructor-arg&gt;
  &lt;constructor-arg name="arg2"&gt;&lt;value&gt;${arg2}&lt;/value&gt;&lt;/constructor-arg&gt;
  &lt;constructor-arg name="arg3"&gt;&lt;value&gt;${arg3}&lt;/value&gt;&lt;/constructor-arg&gt;
&lt;/bean&gt;
</pre>
<p>
In Yaml it's more natural, just give the key names for constructor argument a name.
</p>
<H4>Inner beans</H4>
<p>
You can define beans inside properties and constructor arguments, like this:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="D\E\F" scope="prototype"&gt;
        &lt;property name="someProperty"&gt;
            &lt;bean class="A\B\C" scope="prototype"/&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<p>
Ding will automatically choose a name for this inner bean. The same syntax applies to
constructor arguments as well.
</p>
<H4>Method injection</H4>
<p>
Suppose you have a singleton bean, and you need to have one of its methods to return an instance
of one of its dependencies, but this dependency has the scope 'prototype'. The problem here
is that when the container created the singleton, it injected its dependencies right in the
beginning of its lifecycle, meaning that every access to the prototype dependency bean will always
be to the same instance. If this dependency is a prototype scoped bean, this is not what you want.
</p>
<p>
To help you resolve these kind of issues, the controller offers method injection. Take a look:
</p>

<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="dependencyName" class="AClass" scope="prototype"/&gt;
    &lt;bean id="singletonBean" class="SingletonClass" scope="singleton"&gt;
        &lt;lookup-method name="createDependency" bean="dependencyName"/&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>

<p>
In this example, the singleton just uses createDependency() to get instances of the bean named "dependencyName".
The container will (via AOP) take care of the rest ;)
</p>
<H4>Bean inheritance</H4>
<p>
Since version 1.1.0, Ding accepts bean inheritance via the 3 providers, xml, yaml, and annotations.
</p>
<pre name="code" class="xml">
  &lt;bean id="parentBean" abstract="true"&gt;
    &lt;property name="someProperty">&lt;ref bean="aDependencyBean"/&gt;&lt;/property&gt;
    &lt;aspect ref="aspectBean" type="method"&gt;
        &lt;pointcut expression="^get.*" method="invoke"/&gt;>
    &lt;/aspect&gt;
  &lt;/bean&gt;
  &lt;bean id="childBean" parent="parentBean" class="MyBean" scope="singleton"&gt;
    &lt;property name="someOtherProperty"&gt;&lt;value&gt;blah&lt;/value>&lt;/property&gt;
  &lt;/bean&gt;
</pre>
<p>
This code uses the "abstract" attribute to indicate that "parentBean" cant be instantiated, and it's just
a template bean (this is not required, but recommended). The bean "childBean" is declared by using the
attribute "parent" to specify the name of a bean that is used to inherit stuff from. Currently, you
can inherit everything, and override the desired things explicitely.
</p>
<p>
Also, since 1.1.0, OOP inheritance is also supported, like so:
</p>
<pre name="code" class="php">
/**
 * @Component
 */
abstract class AParentClass
{
    /** @Resource */
    protected $someProperty;
    public function setSomeProperty($value)
    {
        $this->someProperty = $value;
    }

    public function getSomeProperty()
    {
        return $this->someProperty;
    }
}

/**
 * @Component
 */
class AParentClass2 extends AParentClass
{
    /** @Resource */
    protected $someOtherProperty;
    public function setSomeOtherProperty($value)
    {
        $this->someOtherProperty = $value;
    }

    public function getSomeOtherProperty()
    {
        return $this->someOtherProperty;
    }
}

/**
 * This is our bean.
 * @Component(name=childBean)
 * @Scope(value=singleton)
 */
class MyBean extends AParentClass2
{
    public function __construct()
    {

    }
}
</pre>
<p>
When creating the bean "childBean", it will have injected all the properties specified in the
parent classes ("someProperty" and "someOtherProperty").
</p>
<p>
Full examples:
<ul>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/inheritance-xml">Xml</a></li>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/inheritance-yaml">Yaml</a></li>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/inheritance-annotations">Annotations</a></li>
</ul>
</p>
<H4>Wiring By Type</H4>
<p>
The annotations driver supports the @Inject annotation, that can be used in properties, methods, and constructor
arguments.
</p>
<p>
The full example is available <a href="https://github.com/marcelog/Ding/tree/master/docs/examples/InjectAnnotation">here</a>.
</p>
<pre name="code" class="php">
/**
 * @Component
 */
class UserService
{
    /**
     * @Inject(type="IUserRepository")
     */
    protected $repository;
}
</pre>
<p>
Since php has dynamic typing, you have to specify a class name (or interface) in the "type" argument of the
annotation. In this case, if a bean that implements IUserRepository is found, it will be injected.
</p>
<p>
If multiple beans are found (or none at all), an InjectByTypeException is thrown, because Ding wont be able to
choose between any of them. You can specify a bean as a "primary" candidate to avoid throwing this exception and
tell the container which is the preferred bean to choose:
</p>
<pre name="code" class="php">
interface IUserRepository
{
}

/**
 * @Component
 * @Primary
 */
class AUserRepository implements IUserRepository
{
}

/**
 * @Component
 */
class AnotherUserRepository implements IUserRepository
{
}

/**
 * @Component
 */
class UserService
{
    /**
     * @Inject(type="IUserRepository")
     */
    protected $repository;
}
</pre>
<p>
In this case, the bean of class AUserRepository will be chosen to be injected into the UserService bean.
You can also use @Primary for @Bean methods, and can also specify it as @Bean(primary="true").
</p>
<p>
If you are using xml:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
  &lt;bean id="aUserRepository" class="AUserRepository" primary="true"/&gt;
  &lt;bean id="anotherUserRepository" class="AUserRepository"/&gt;
&lt;/beans&gt;
</pre>
<p>
If you are using yaml:
</p>
<pre name="code" class="php">
beans:
  aUserRepository:
    class: AUserRepository
    primary: true
  anotherUserRepository:
    class: AnotherUserRepository
</pre>
<p>
You can also specify a bean name to be chosen when multiple candidates are available, by using
the @Named annotation, for properties and methods:
</p>
<pre name="code" class="php">
/**
 * @Component
 */
class UserService
{
    /**
     * @Inject(type="IUserRepository")
     * @Named(name="iPrefferThisBeanImplementation")
     */
    protected $repository;
}
</pre>
<p>
If you want to inject ALL beans of a given type, just specify the "type" as an array, like:
</p>
<pre name="code" class="php">
/**
 * @Component
 */
class UserService
{
    /**
     * @Inject(type="IUserRepository[]")
     */
    protected $repositories;
}
</pre>
<p>
In this case, all instances will be injected as an array of beans.
</p>
<p>
By default, all injected by type properties are required, so an InjectByTypeException will be thrown if no
candidates are found to inject. If you dont mind not having anything to inject, you can specify
"required=false":
</p>
<pre name="code" class="php">
interface IUserRepository
{
}

/**
 * @Component
 */
class UserService
{
    /**
     * @Inject(type="IUserRepository[]", required="false")
     */
    protected $repositories;
}
</pre>
<p>
So if no candidates are found, no exception will be thrown.
</p>
<p>
You can also use @Inject in methods. You can use any method name you like:
</p>
<pre name="code" class="php">
/**
 * @Component
 */
class UserService
{
    protected $repositories;

    /**
     * @Inject(type="IUserRepository[]")
     */
    public function initializeRepositories(array $repositories)
    {
        $this->repositories = $repositories;
    }
}
</pre>
<p>
Since php does not allow you to specify an array of objects for a given class, you need
to set the parameter type as "array", and specify the type of the objects to be injected in
the "type" argument of the Inject annotation. But if you want to inject a single object,
this will suffice:
</p>
<pre name="code" class="php">
/**
 * @Component
 */
class UserService
{
    protected $repository;

    /**
     * @Inject
     */
    public function setRepository(IUserRepository $repository)
    {
        $this->repository = $repository;
    }
}
</pre>
<p>
@Inject can also be used in constructors:
</p>
<pre name="code" class="php">
/**
 * @Component
 */
class UserService
{
    /**
     * @Inject
     */
    public function __construct(IUserRepository $userRepository, IScheduleRepository, $scheduleRepository)
    {
    }
}
</pre>
<p>
If one of the constructor arguments has no defined type, it will be not eligible for injection by type, and will be skipped.
In this case, you can mix it with @Value:
</p>
<pre name="code" class="php">
/**
 * @Component
 */
class UserService
{
    /**
     * @Inject
     * @Value(name="otherArgument", value="${user.property}")
     */
    public function __construct(IUserRepository $repository, $otherArgument)
    {
    }
}
</pre>
<p>
If you need to mix array AND scalar constructor injection with @Inject:
</p>
<pre name="code" class="php">
/**
 * @Component
 */
class UserService
{
    /**
     * @Inject
     * @Inject(name="otherArgument", type="IUserRepository[]")
     */
    public function __construct(IUserRepository $repository, $otherArgument)
    {
    }
}
</pre>
<p>
To use @Named in constructor arguments, you need to specify the name of the parameter you are referring
to. In the following example, the container will try to inject a IUserRepository component into the $repository
argument. If multiple candidates are found, the @Named will choose make the container choose the bean with the name
"preferredBeanName" for the argument $repository:
</p>
<pre name="code" class="php">
/**
 * @Component
 */
class UserService
{
/**
 * @Component
 */
class UserService
{
    /**
     * @Inject(name="repository", type="IUserRepository")
     * @Named(name="preferredBeanName", arg="repository")
     */
    public function __construct($repository)
    {
    }
}
</pre>
<p>
You can also annotate @Bean methods:
</p>
<pre name="code" class="php">
/**
 * @Configuration
 */
class ServicesConfiguration
{
    /**
     * @Inject
     * @Bean
     * @Value(name="otherArgument", value="${user.property}")
     */
    public function userService(IUserRepository $repository, $otherArgument)
    {
        return new UserService($repository, $otherArgument);
    }
}
</pre>
<H4>Annotations metadata</H4>
<ul>
  <li><u>Name:</u>The name of the annotation (i.e: @InitMethod).
  <li><u>Arguments:</u>The annotations arguments. For example @InitMethod(method=xxx)
  will result in an annotation named InitMethod with an argument 'method' having the
  value 'xxx'.</li>
</ul>

<H4>Container</H4>
<p>
The container is a factory of beans. It constructs an instance of a bean using the
metadata associated with it (and its subparts, like properties, annotations, etc).
</p>

<H4>Handling errors</H4>
<p>
The container does a set_error_handler() when it bootstraps. Whenever the phpvm calls this handler with
an error (or warning, or notice, or whatever), ding will dispatch the event "dingError", so any bean(s)
listening for this event will receive it as an <a href="https://github.com/marcelog/Ding/blob/master/src/mg/Ding/Helpers/ErrorHandler/ErrorInfo.php">ErrorInfo</a>.
</p>
<p>
An example is <a href="https://github.com/marcelog/Ding/tree/master/docs/examples/ErrorHandler">here.</a>
</p>
<H4>Handling signals</H4>
<p>
On SAPI's cgi and cli, it might be needed to handle posix signals. The container uses the pcntl extension to catch
signals SIGQUIT, SIGHUP, SIGINT, SIGCHLD, SIGTERM, SIGUSR1, SIGUSR2 when it bootstraps. Whenever a signal is received,
ding will dispatch the event "dingSignal", passing as argument the signal number, so any bean(s) listening for this event will receive it.
</p>
<p>
An example is <a href="https://github.com/marcelog/Ding/tree/master/docs/examples/SignalHandler">here.</a>
</p>
<H4>Handling shutdown</H4>
<p>
The container does a register_shutdown_function() when it bootstraps. When the phpvm calls this handler, ding will dispatch the event "dingShutdown", so any bean(s)
listening for this event will receive it.
</p>
<p>
An example is <a href="https://github.com/marcelog/Ding/tree/master/docs/examples/ShutdownHandler">here.</a>
</p>

<H4>Aware Interfaces</H4>
<ul>
  <li><u>Ding\Container\IContainerAware</u>: Whenever ding is going to instantiate a bean whose class implements IContainerAware interface, it will inject the container instace to this bean</li>
  <li><u>Ding\Bean\IBeanNameAware</u>: Whenever ding is going to instantiate a bean whose class implements IBeanNameAware interface, it will inject the name of the bean</li>
  <li><u>Ding\Bean\IAspectManagerAware</u>: Whenever ding is going to instantiate a bean whose class implements IAspectManagerAware interface, it will inject current instance of the aspect manager (giving the ability to inject pointcuts, aspects, and general aop management).</li>
  <li><u>Ding\Bean\IMessageSourceAware</u>: Whenever ding is going to instantiate a bean whose class implements IMessageSourceAware interface, it will inject current instance of the message source (providing i18n capabilities).</li>
  <li><u>Ding\Bean\IResourceLoaderAware</u>: Whenever ding is going to instantiate a bean whose class implements IResourceLoaderAware interface, it will inject the instance of the resource loader in use, which is usually the container itself.</li>
  <li><u>Ding\Logger\ILoggerAware</u>: Whenever ding is going to instantiate a bean whose class implements ILoggerAware interface, it will inject the instance of the logger (log4php) currently in use by the container, so you can log there. The logger will have the name of the class (where '\' are replaced by '.')</li>
  <li><u>Ding\Reflection\IReflectionFactoryAware</u>: Whenever ding is going to instantiate a bean whose class implements IReflectionFactoryAware interface, it will inject the instance of ReflectionFactory in use, so you can access annotations, etc.</li>
</ul>

<H4>Extension points</H4>
<p>
If you're wondering about how to extend Ding with different or new features,
there are some predefined "kind" of extension points:

<ul>
  <li>Drivers</li>
  <li>Bean definition Providers</li>
  <li>Aspect/Pointcut definition providers</li>
  <li>Helpers</li>
</ul>
</p>
<H4><u>Drivers</u></H4>
<p>
Drivers are normal "lifecyclers". These can be any object that implements
ILifecycleListener and listens on one or more of the container lifecycle events:
These classes usually reside in the namespace Ding\Bean\Factory\Driver.
</p>
<ul>
  <li><u>AfterConfig</u></li>
  <li><u>BeforeDefinition:</u></li>
  <li><u>AfterDefinition</u></li>
  <li><u>BeforeCreate</u></li>
  <li><u>AfterCreate</u></li>
  <li><u>BeforeAssemble</u></li>
  <li><u>AfterAssemble</u></li>
</ul>
<p>
Each lifecycle event triggers a chain of the lifecyclers for that particular
event, so the order is important.
</p>
<p>
Just like an aware interface, whenever ding instantiates a bean of a class that implements any of:
the bean will be registered in the given lifecycle points. See docs/examples/lifecycle.
This will allow you to extend the container functionality as much as you like.
</p>
<ul>
  <li>Ding\Bean\Lifecycle\IAfterConfigListener</li>
  <li>Ding\Bean\Lifecycle\IBeforeDefinitionListener</li>
  <li>Ding\Bean\Lifecycle\IAfterDefinitionListener</li>
  <li>Ding\Bean\Lifecycle\IBeforeCreateListener</li>
  <li>Ding\Bean\Lifecycle\IAfterCreateListener</li>
  <li>Ding\Bean\Lifecycle\IBeforeAssembleListener</li>
  <li>Ding\Bean\Lifecycle\IAfterAssembleListener</li>
</ul>
</p>
<H4>Helpers</H4>
<p>
Helpers reside in the namespace Ding\Helpers. The helpers are usually normal
beans, lets call them "user space" code (meaning that they
are not part of Ding's architecture per se, unlike Drivers that are
active players in the bean creation process).
</p>
<H4>Bean Definition Providers</H4>
<p>
If you need to provider bean definitions, implement IBeanDefinitionProvider. Whenever
a bean is created that implements this interface, it is automatically registered as a bean
definition provider and will be called by the container whenever necessary.
</p>
<H4>Aspect/Pointcut Definition Providers</H4>
<p>
If you need to provider aspect and pointcuts definitions, implement IAspectProvider and/or
IPointcutProvider. Whenever a bean is created that implements this interface, it is automatically
registered by the container into the AspectManager, and will be called whenever necessary.
</p>
<H4>ReflectionFactory</H4>
<p>
The namespace Ding\Reflection contains ReflectionFactory. This factory is
used throughout the container and its extension points.
</p>
<a href="#" class="next-link"><strong>Back</strong></a>

                  <a name="events" id="events"></a>
                  <div class="line">
                        <h3>3. Events and event driven programming support</h3>
                    <!-- <a href="#" class="next-link"><strong>Next</strong></a> -->
                  </div>
                  <div class="hr-1"><hr /></div>
<p>
Events are supported by the container itself. This means that you can register
as many events and as many listeners per events as you need. This is useful so you can
decouple your code a little more (i.e: updating some entity would trigger accounting
events, that are listened to by some other beans that may be responsible to propagate
this events to other systems).
</p>
<p>
The container supports triggering and listening for events, via 2 methods:
</p>
<pre name="code" class="php">
    public function eventListen($eventName, $beanName);
    public function eventDispatch($eventName, $data = null);
</pre>
<p>
So you may programatically register a new listener by issuing:
</p>
<pre name="code" class="php">
$container->eventListen('someEvent', 'myService');
</pre>
<p>
And then you can trigger it (also programatically) with:
</p>
<pre name="code" class="php">
$container->eventDispatch('someEvent', $entity);
</pre>
<p>
The event is a string (as you can see), and also the handler is passed with a
bean name (also a string). These handlers will only be instantiated when needed (i.e:
the event has been triggered). The convention is that the container will look for a
method name "onSomeEvent()" and call it with $entity.
</p>
<p>
You can also declare the beans that listen for particular events right in the
container configuration.
</p>
<H4>Using the xml provider</H4>
<pre name="code" class="php">
&lt;beans&gt;
  &lt;bean id="bean" class="Bean" scope="singleton" listens-on="bean2Created"/&gt;
&lt;/beans&gt;
</pre>
<p>
The "listens-on" value is a csv string of events, lower camel cased.
</p>
<H4>Using the yaml provider</H4>
<pre name="code" class="php">
beans: !!map
  bean3:
    class: Bean3
    scope: singleton
    listens-on: bean2Created

</pre>
<p>
The "listens-on" value is a csv string of events, lower camel cased.
</p>
<H4>Using the annotations provider</H4>
<pre name="code" class="php">
/**
 * @Configuration
 */
class Config
{
    /**
     * @Bean(class=Bean4)
     * @Scope(value=singleton)
     * @ListensOn(value=bean2Created)
     */
    public function someBean()
    {
        return new Bean4;
    }
}
</pre>
<p>
Since 1.1.3, events are supported in @Component and @Bean. If you want to specify
multiple events, you can do so in this way:
</p>
<pre name="code" class="php">
/**
 * @Component
 * @ListensOn(value={bean2Created, anotherEvent})
 */
class SomeComponent
{
...
}

/**
 * @Configuration
 */
class Config
{
    /**
     * @Bean(class=Bean4)
     * @Scope(value=singleton)
     * @ListensOn(value={bean2Created, anotherEvent})
     */
    public function someBean()
    {
        return new Bean4;
    }
}
</pre>
<H4>Predefined events in the container</H4>
<p>
Ding defines the following events by default:
<ul>
  <li>dingError: Triggered whenever php triggers an error, notice, etc.</li>
  <li>dingShutdown: Triggered when php is shutting down.</li>
  <li>dingSignal: Available for SAPI's cli and cgi. Triggered when the container catches a posix signal.</li>
</ul>
</p>
<a href="#" class="next-link"><strong>Back</strong></a>
                  <a name="resources" id="resources"></a>
                  <div class="line">
                        <h3>4. Using Resources</h3>
                    <!-- <a href="#" class="next-link"><strong>Next</strong></a> -->
                  </div>
                  <div class="hr-1"><hr /></div>
<p>
Resources are just a small abstraction level above the native stream implementation of php. For examples see
docs/examples/resources.
</p>
<p>
 You can get resources directly from the container. Since the container implements <a href="https://github.com/marcelog/Ding/blob/master/src/mg/Ding/Resource/IResourceLoader.php">Ding\Resource\IResourceLoader</a>,
 you can call getStream($path) on it. You can also use resources by yourself, without involving the container.
</p>
<p>
A resource implements <a href="https://github.com/marcelog/Ding/blob/master/src/mg/Ding/Resource/IResource.php">Ding\Resource\IResource</a>.
</p>
<H4>Available implementations</H4>
<ul>
  <li><u>FilesystemResource</u>: Can be used to get resources for either relative or absolute paths. Can be used with or without the scheme <b>file://</b></li>
  <li><u>IncludePathResource</u>: Can be used to get resources inside the include_path. Can be used with or without the scheme <b>file://</b> and <b>includepath://</b></li>
  <li><u>URLResource</u>: Directly access php supported scheme's. See: <a href="http://www.php.net/manual/en/wrappers.php">http://www.php.net/manual/en/wrappers.php</a>
</ul>
<pre name="code" class="php">
$resource = $container->getResource('includepath://somefile.php');
</pre>
<p>
Or:
</p>
<pre name="code" class="php">
$resource = new IncludePathResource('somefile.php');
</pre>
<p>
Some other examples:
</p>
<pre name="code" class="php">
$resource = $container->getResource('zip://file.zip#README.txt');
</pre>
<pre name="code" class="php">
$resource = new URLResource('zip://file.zip#README.txt');
</pre>
<pre name="code" class="php">
$resource = $container->getResource('file:///some/file/here.txt');
</pre>
<pre name="code" class="php">
$resource = new FilesystemResource('file:///some/file/here.txt');
</pre>
<H4>IResourceLoaderAware interface</H4>
<p>
Implement <a href="https://github.com/marcelog/Ding/blob/master/src/mg/Ding/Resource/IResourceLoaderAware.php">Ding\Resource\IResourceLoaderAware</a> interface in your own beans and they will be automatically injected with the resource loader (the container)
in use.
</p>
<H4>Resources as dependencies</H4>
<p>
You can also declare resources in your bean properties and constructor arguments, like:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="aBean" class="MyBeanClass" scope="singleton"&gt;
        &lt;property name="aResource"&gt;&lt;value&gt;resource://${anUrl}&lt;/value&gt;&lt;/property&gt;
        &lt;property name="aResource2"&gt;&lt;value&gt;resource://includepath://config.php&lt;/value&gt;&lt;/property&gt;
        &lt;constructor-arg&gt;&lt;value&gt;resource://http://www.something.com&lt;/value&gt;&lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<p>
Ding will autodetect the <b>resource://</b> prefix and return a property of type IResource instead of the string.
</p>
<a href="#" class="next-link"><strong>Back</strong></a>
                  <a name="i18n" id="i18n"></a>
                  <div class="line">
                        <h3>5. Internationalization (i18n) support</h3>
                    <!-- <a href="#" class="next-link"><strong>Next</strong></a> -->
                  </div>
                  <div class="hr-1"><hr /></div>
<p>
Ding provides i18n functionality, so you can support multiple languages in your application.<br/>
see docs/examples/i18n for a quick example.
</p>
<p>
Suppose you want to ship your application in en_US and es_AR languages. Also, suppose your application
can be divided into 3 big modules:
</p>
<ul>
<li>Customers</li>
<li>Products</li>
<li>Billing</li>
</ul>
<p>
You would need 3 files named like this somewhere in your <b>include_path</b>:
</p>
<ul>
<li>customers_es_AR.properties / customers_en_US.properties</li>
<li>products_es_AR.properties / products_en_US.properties</li>
<li>billing_es_AR.properties / billing_en_US.properties</li>
</ul>
<p>
Sample contents for the files:
</p>
<p>
customers_es_AR.properties:
</p>
<pre name="code" class="php">
message.example = "Hola! esto es un argumento {1}"
</pre>
<p>
customers_en_US.properties:
</p>
<pre name="code" class="php">
message.example = "Hello! this is an argument {1}"
</pre>
<h4>Configuring the container</h4>
<p>
Whenever ding finds a bean named "messageSource", it will create it and use it to
resolve messages:
</p>
<pre name="code" class="xml">
    &lt;bean id="messageSource" class="Ding\MessageSource\Impl\MessageSourceImpl" scope="singleton"&gt;
       &lt;property name="basenames"&gt;
           &lt;array&gt;
               &lt;entry key="0"&gt;&lt;value&gt;customers&lt;/value&gt;&lt;/entry&gt;
               &lt;entry key="1"&gt;&lt;value&gt;products&lt;/value&gt;&lt;/entry&gt;
               &lt;entry key="2"&gt;&lt;value&gt;billing&lt;/value&gt;&lt;/entry&gt;
           &lt;/array&gt;
       &lt;/property&gt;
    &lt;/bean&gt;
</pre>

<p>
A <a href="https://github.com/marcelog/Ding/blob/master/src/mg/Ding/MessageSource/Impl/MessageSourceImpl.php">MessageSourceImpl</a> implements the interface <a href="https://github.com/marcelog/Ding/blob/master/src/mg/Ding/MessageSource/IMessageSource.php">IMessageSource</a>:
</p>
<pre name="code" class="php">
interface IMessageSource
{
    public function getMessage($bundle, $message, array $arguments, $locale = 'default');
}
</pre>
<p>
The container implements this interface, so you can call
</p>
<pre name="code" class="php">
echo $container->getMessage('products', 'message.example', array('anArgument'), 'en_US');
</pre>
<p>
Or:
</p>
<pre name="code" class="php">
echo $container->getMessage('products', 'message.example', array('anArgument'));
</pre>
<p>
And the messages will be looked for in the products_default.properties file.
</p>
<H4>IMessageSourceAware</H4>
<p>
Each bean that implements the <a href="https://github.com/marcelog/Ding/blob/master/src/mg/Ding/MessageSource/IMessageSourceAware.php">IMessageSourceAware</a> interface, will be autoinjected with
the message source in use (the container).
</p>
<pre name="code" class="php">
interface IMessageSourceAware
{
    public function setMessageSource(IMessageSource $messageSource);
}
</pre>
<a href="#" class="next-link"><strong>Back</strong></a>

                  <a name="aop" id="aop"></a>
                  <div class="line">
                        <h3>6. Aspect Oriented Programming</h3>
                    <!-- <a href="#" class="next-link"><strong>Next</strong></a> -->
                  </div>
                  <div class="hr-1"><hr /></div>
<p>
This article has a little background on AOP using Ding: <a href="http://marcelog.github.com/articles/ding_php_aop_aspect_oriented_programming.html">here</a>
</p>
                  <p>
Ding has an implementation of the interceptor pattern, which is used to bring
aop in the framework. Currently, there are 2 available kind of interceptors, both
of them will call all aspects in a chained fashion. Either of those chained aspects
can break or continue the chain by choosing to (or not to) call the proceed() method.
</p>
<p>
Since 1.5.1 the proceed() method supports arguments. All the arguments passed to proceed() will
override the arguments used to call the original method.
</p>
<ul>
  <li><u>Method</u>: Called when the method is called.</li>
  <li><u>Exception</u>: Called when the called method has thrown an exception not catched.</li>
</ul>
<p>
The aspects are declared in the xml provider like this (yaml is supported, please see: docs/examples/yaml for an example):
</p>

<pre name="code" class="xml">
&lt;bean id="some" class="AClass" scope="prototype"&gt;
    &lt;aspect ref="AnAspectBean" type="method"&gt;
        &lt;pointcut expression="targetMethod" method="invoke"/&gt;
    &lt;/aspect&gt;
&lt;/bean&gt;<br/>
</pre>
<p>
The above example defines a bean named "some". When the container is requested to return an
instance of this bean, it will notice that is has an aspect attached, so the bean's class is
automatically proxied and the instance of that proxy is what is really returned.<br/><br/>
In this case, the aspect references another bean that should also be known to the container. That
bean must have a method named like in the method attribute, which is to be called.
</p>
<p>
NOTE: Since 1.1.0, when using bean inheritance, aspects specified on parent beans will also be
applied to children beans that inherit from this parent.
</p>
<p>
Notice the "type" attribute in the aspect tag. The other possible value for this attribute is "exception", this will attach an
ExceptionInterceptor instead of a MethodInterceptor.
</p>
<p>
Whenever a call is made to the method defined in the pointcut tag (in this case the method is called
targetMethod), the method on your bean will be called. The same applies to exception interceptors.
</p>
<p>
You can also use regular expressions to define a pointcut for more than one method. The syntax
for the regular expression is the same as preg_match(), please see the php manual page for
this function for details. Example:
</p>
<pre name="code" class="xml">
&lt;bean id="some" class="AClass" scope="prototype"&gt;
    &lt;aspect ref="AnAspectBean" type="method"&gt;
        &lt;pointcut expression="^get$" method="invoke"/&gt;
    &lt;/aspect&gt;
&lt;/bean&gt;
</pre>

<H4>Sharing pointcuts (aka global pointcuts)</H4>
<p>
You can define global pointcuts and use them in your aspect definitions:
</p>

<pre name="code" class="xml">
&lt;pointcut id="aPointcut" expression="^get$"/&gt;
&lt;bean id="some" class="AClass" scope="prototype"&gt;
    &lt;aspect ref="AnAspectBean" type="method"&gt;
        &lt;pointcut pointcut-ref="aPointcut" method="invoke"/&gt;
    &lt;/aspect&gt;
&lt;/bean&gt;
</pre>

<H4>Global aspects</H4>
<p>
You can define global aspects using regular expressions for classes and references
to global pointcuts (which can also use regular expressions):
</p>

<pre name="code" class="xml">
&lt;pointcut id="aPointcut" expression="^get$"/&gt;
&lt;aspect id="anAspect" expression="Service$" ref="AnAspectBean" type="method"&gt;
  &lt;pointcut pointcut-ref="aPointcut"/&gt;
&lt;/aspect&gt;
</pre>

<hr/>
<p>
In the above example, the expression attribute of the aspect declaration is applied
to the class names for the beans. If the name of the class is matched, then the pointcuts
expressions are tried.
</p>
<p>
NOTE: Since 1.1.0, Ding will apply global aspects applied to parent classes as well, so if you apply
a global aspect to a class-expression that matches with a parent class of a bean, the bean
will have that aspect applied.
</p>
<p>
So you can define pointcuts inside aspects or globally. You can also define aspects in beans
or globally. The aspects can have references to global pointcuts or the pointcut definitions
themselves.
</p>
<H4>Using annotations</H4>
<p>
You may annotate any of your classes with @Aspect, this will tell Ding to scan
the methods of this class and look for @ExceptionInterceptor and @MethodInterceptor:
</p>
<pre name="code" class="php">
/**
 * @Aspect
 */
class AspectA
{
    /**
     * @MethodInterceptor(class-expression=C.+,expression=g.+)
     * @ExceptionInterceptor(class-expression=C.+,expression=getB)
     */
    public function invoke(MethodInvocation $invocation)
    {
        try
        {
            echo "Before: " . $invocation->getOriginalInvocation() . "\n";
            $invocation->proceed('b', 'c', 'd');
            echo "After\n";
        } catch(Exception $e) {
            echo "Move along, nothing happened here.. \n";
        }
    }

    public function __construct()
    {
    }
}
</pre>
<H4>Example</H4>
<ul>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/aop">docs/examples/aop</a>: Using the xml provider.</li>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/aop-regex">docs/examples/aop-regex</a>: Using the xml provider and regular expressions.</li>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/aop-global">docs/examples/aop-global</a>: Using the xml provider, regular expressions, and global (shared) pointcuts.</li>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/aop-annotation">docs/examples/aop-annotation</a>: Using the annotations provider.</li>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/yaml">docs/examples/yaml</a>: Using the yaml provider.</li>
</ul>
<a href="#" class="next-link"><strong>Back</strong></a>
                  <a name="config" id="config"></a>
                  <div class="line">
                        <h3>7. Configuring the container</h3>
                    <!-- <a href="#" class="next-link"><strong>Next</strong></a> -->
                  </div>
                  <div class="hr-1"><hr /></div>
                  <p>
The container::getInstance() method accepts an array that is used configure the
framework.
</p>
<pre name="code" class="php">
$a = ContainerImpl::getInstance($properties);
</pre>
<H4>Logging</H4>
<p>
Use the optional property:
</p>
<pre name="code" class="php">
$properties['ding']['log4php.properties'] => './log4php.properties'
</pre>

<H4>Bean Factory Providers</H4>
<p>
You may configure any of the bean definition providers available:
</p>
<ul>
  <li>xml: Parses the given XML file(s), usually beans.xml and get bean definitions from there. Requires the property 'filename'.</li>
  <li>yaml: Parses the given YAML file(s), usually beans.yaml and get bean definitions from there. Requires the property 'filename'.</li>
  <li>annotation: Extracts bean definitions and other information right from the annotated code. Requires the property 'scanDir'.</li>
</ul>
<p>
These providers are configured with their own properties:
</p>
<ul>
  <li>$properties['ding']['factory']['bdef']['xml']</li>
  <li>$properties['ding']['factory']['bdef']['yaml']</li>
  <li>$properties['ding']['factory']['bdef']['annotation']</li>
</ul>

<p>
Example:
</p>
<pre name="code" class="php">
$properties['ding']['factory']['bdef']['xml'] = array(
    'filename' => 'beans.xml'
)

$properties['ding']['factory']['bdef']['annotation'] = array(
    'scanDir' => array(__DIR__)
)
</pre>

<p>
You can also specify multiple files, for either xml or yaml providers, like:
</p>
<pre name="code" class="php">
$properties['ding']['factory']['bdef']['xml'] = array(
    'filename' => array('beans.xml', 'otherBeans.xml')
)

$properties['ding']['factory']['bdef']['yaml'] = array(
    'filename' => array('beans.yaml', 'otherBeans.yaml')
)
</pre>

<p>
You can also specify multiple search directories (paths), for either xml or yaml providers, like:<br/>
</p>
<pre name="code" class="php">
$properties['ding']['factory']['bdef']['yaml'] = array(
    'filename' => array('beans.yaml', 'otherBeans.yaml'), 'directories' => array('/etc/Ding', '/usr/local/etc/Ding')
)
</pre>
<p>
This will tell the yaml provider (you can also use it with the xml provider) to look for the bean
files beans.yaml and otherBeans.yaml in the directories specified. The order of the
directories is important, so the file used will be the first available one.
</p>
<H4>User properties</H4>
<p>
Use the optional property: $properties['ding']['properties'] to
specify any key/value pair that you may want search and replace via the PropertyFilter. Example:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype"&gt;
        &lt;property name="someProperty"&gt;
            &lt;value&gt;${some.value}&lt;/value&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<pre name="code" class="php">
$properties['ding']['factory']['properties'] = array(
    'some.value' => 'This is the final property value'
)
</pre>
<p>
<b>NOTE:</b> If a property starts with "php.", like "php.date.timezone", ding will automatically
call ini_set() for that property, like: ini_set('date.timezone', value). See docs/examples/PhpProperties.
</p>
<p>
You can also configure the <b>PropertiesHolder</b> bean to inject properties files:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
   &lt;bean id="PropertiesHolder" class="Ding\Helpers\Properties\PropertiesHelper" scope="singleton"&gt;
       &lt;property name="locations"&gt;
         &lt;array&gt;
           &lt;entry key="0"&gt;&lt;value&gt;resource://includepath://file.properties&lt;/value&gt;&lt;/entry&gt;
           &lt;entry key="1"&gt;&lt;value&gt;other.properties&lt;/value&gt;&lt;/entry&gt;
           &lt;entry key="2"&gt;&lt;value&gt;file://./user.properties&lt;/value&gt;&lt;/entry&gt;
           &lt;entry key="3"&gt;&lt;value&gt;file://./php.properties&lt;/value&gt;&lt;/entry&gt;
           &lt;entry key="4"&gt;&lt;value&gt;file://${some.value}/php.properties&lt;/value&gt;&lt;/entry&gt;
         &lt;/array&gt;
       &lt;/property&gt;
   &lt;/bean&gt;
   &lt;bean id="beanName" class="A\B\C" scope="prototype"&gt;
       &lt;property name="someProperty"&gt;
           &lt;value&gt;${some.value}&lt;/value&gt;
       &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<p>
So you can have your own properties and the ones that affect php behavior (i.e: "php." properties) in your
own separate config files.
</p>
<p>
Sample properties file:
</p>
<pre name="code" class="php">
some.value=value
php.some.php.property=value
</pre>
<p>
You can even use properties inside the properties holder definition, like:
</p>
<pre name="code" class="xml">
&lt;beans&gt;
   &lt;bean id="PropertiesHolder" class="Ding\Helpers\Properties\PropertiesHelper" scope="singleton"&gt;
       &lt;property name="locations"&gt;
         &lt;array&gt;
           &lt;entry key="0"&gt;&lt;value&gt;resource://file://${config.dir}/file.properties&lt;/value&gt;&lt;/entry&gt;
         &lt;/array&gt;
       &lt;/property&gt;
   &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<p>
The property <b>config.dir</b> must now be defined when instantiating the container:
</p>
<pre name="code" class="php">
$options = array('ding' => array(
    'factory' => array(
        'properties' => array('config.dir' => '/etc/config')
    )
));
</pre>
<p>
When the properties holder is loaded, the property will complete the path for the file "file.properties".
</p>
<H4>Cache Subsystems</H4>
<p>
The cache subsystems use $properties['ding']['cache']. The subsystems are:
</p>
<ul>
  <li><u>proxy</u>: To cache proxy definitions: its expensive to create proxies
  because php lacks this hability, so we have to actually generate code. This code
  can be cached.</li>
  <li><u>annotations</u>: To cache annotations, its *really* expensive if you have
  a large source tree or use them a lot. So we cache the annotations for each class and
  the files and directories scanned (along with all autodiscovered classes there).</li>
  <li><u>bdef</u>: To cache BeanDefinitions so no xml's or annotations have to be
  reparsed per every request.</li>
  <li><u>beans</u>: To cache the beans themselves. This is actually not so easy as it
  sounds, so dont expect it to work as intended. Note: this is not a flaw of Ding itself but
  inherent to the architecture used generally in php, the lack of the concept of an
  application server, etc. It is recomended to use the dummy implementation for this cache.</li>
  <li><u>aspect</u>: To cache aspect and pointcut definitions (i.e: AspectManager).</li>
</ul>
<p>
The resulting properties needed to configure each one of the cache subsystems:
</p>

<ul>
  <li>$properties['ding']['cache']['proxy']</li>
  <li>$properties['ding']['cache']['bdef']</li>
  <li>$properties['ding']['cache']['beans']</li>
  <li>$properties['ding']['cache']['aspect']</li>
  <li>$properties['ding']['cache']['annotations']</li>
</ul>

<p>
In turn, each one of these entries, require the 'impl' key to point to one
of the possible cache implementations:
</p>
<ul>
  <li><u>dummy</u>: Does not cache at all.</li>
  <li><u>file</u>: Uses the filesystem. Requires the additional option 'directory'.</li>
  <li><u>apc</u>: Uses apc.</li>
  <li><u>memcached</u>: Uses memcached php extension. Requires additional option 'memcached', an array with: 'host' and 'port'.</li>
  <li><u>zend</u>: Uses Zend_Cache. Requires additional option: 'zend' with an array of options of your choice according to Zend_Cache documentation.</li>
</ul>
<p>
Then, you can configure any of the cache subsystems with any of the cache implementations:
</p>

<pre name="code" class="php">
$properties['ding']['cache']['proxy'] = array(
    'impl' => 'file', 'directory' => '/tmp/Ding/cache'
)

$properties['ding']['cache']['bdef'] = array(
    'impl' => 'memcached', 'memcached' => array('host' => '127.0.0.1', 'port' => 11211)
)

$properties['ding']['cache']['proxy'] = array(
    'impl' => 'apc'
)

$properties['ding']['cache']['aspect'] = array(
    'impl' => 'apc'
)

$properties['ding']['cache']['annotations'] = array(
    'impl' => 'apc'
)

$properties['ding']['cache']['bdef'] = array(
    'impl' => 'dummy'
)
</pre>
<pre name="code" class="php">
$zendCacheOptions = array(
    'frontend' => 'Core',
    'backend' => 'File',
    'backendoptions' => array('cache_dir' => '/tmp/Ding/zend/cache'),
    'frontendoptions' => array('lifetime' => 10000, 'automatic_serialization' => true)
);

$properties['ding']['cache']['bdef'] = array(
    'impl' => 'zend', 'zend' => $zendCacheOptions
)
</pre>
<a href="#" class="next-link"><strong>Back</strong></a>

                  <a name="mvc" id="mvc"></a>
                  <div class="line">
                        <h3>8. The MVC Implementation</h3>
                    <!-- <a href="#" class="next-link"><strong>Next</strong></a> -->
                  </div>
                  <div class="hr-1"><hr /></div>
<H4>Classes</H4>
<ul>
<li>Ding\Mvc\Action</li>
<li>Ding\Mvc\Dispatcher</li>
<li>Ding\Mvc\ModelAndView</li>
<li>Ding\Mvc\RedirectModelAndView</li>
<li>Ding\Mvc\ForwardModelAndView</li>
<li>Ding\Mvc\View</li>
<li>Ding\Mvc\Htt</li>
</ul>
<H4>Interfaces</H4>
<ul>
<li>Ding\Mvc\IMapper</li>
<li>Ding\Mvc\IViewResolver</li>
<li>Ding\Mvc\IViewRender</li>
<li>Ding\Mvc\IHandlerInterceptor</li>
</ul>
<H4>Description</H4>
<p>
The MVC implementation of Ding is in the namespace Ding\Mvc. The components are:
</p>
<ul>
  <li><u>Actions</u>: Actions are strings, that uniquely identifies an action (usually triggered with a request) in
  your software. Actions can have arguments, which are nothing more than key/value
  pairs.</li>
  <li><u>Mapper</u>: The mapper knows and returns the controller that can handle the given Action name.</li>
  <li><u>Dispatcher</u>: The dispatcher is the responsible for calling the right controller with the right Action object.</li>
  <li><u>ModelAndView</u>: This is the result of the execution of a controller. A controller must
  return a ModelAndView object containing the name of the view to render and other optional data.</li>
  <li><u>TwigViewRender</u>: The view is processed by <a href="http://www.twig-project.org/">Twig</a></li>
  <li><u>SmartyViewRender</u>: The view is processed by <a href="http://www.smarty.net">Smarty</a></li>
  <li><u>HttpViewRender</u>: The view is processed by php via include_once.</li>
  <li><u>ForwardModelAndView</u>: This is a special ModelAndView that has the meaning of calling again the
  dispatcher with a new given action and new or same arguments.</li>
  <li><u>RedirectModelAndView</u>: This is a special ModelAndView that has the meaning of redirecting the request
  to somewhere else (i.e: http 302 header).</li>
  <li><u>ViewResolver</u>: The ViewResolver knows how to get a ViewResolver based on the given View name from the ModelAndView object.</li>
  <li><u>View</u>: Views are in charge of rendering the ModelAndView in a proper way for the actor that triggered the request.</li>
  <li><u>Interceptor</u>: Classes that implement IHandlerInterceptor can be used as pre and post interceptors. The dispatcher will
  chain calls to preHandle() and postHandle(). Returning false or a ModelAndView will interrupt the chain, while returning true will
  continue executing it.</li>
</ul>
<H4>HTTP implementation Classes</H4>
<ul>
<li>Ding\Mvc\Http\HttpAction</li>
<li>Ding\Mvc\Http\HttpDispatcher</li>
<li>Ding\Mvc\Http\HttpExceptionMapper</li>
<li>Ding\Mvc\Http\HttpView</li>
<li>Ding\Mvc\Http\HttpViewResolver</li>
<li>Ding\Mvc\Http\HttpViewRender</li>
<li>Ding\Mvc\Http\TwigViewRender</li>
<li>Ding\Mvc\Http\SmartyViewRender</li>
<li>Ding\Mvc\Http\HttpUrlMapper</li>
<li>Ding\Mvc\Http\HttpFrontController</li>
<li>Ding\Mvc\Http\HttpInterceptor</li>
</ul>
<H4>Annotations</H4>
<ul>
<li>@Controller</li>
<li>@RequestMapping(url=xxx)</li>
</ul>
<p>
Both of these annotations need to be present in a controller defined by annotations.<br/>
@Controller will tell the mvc driver to map the class with the content of the url param in the
@RequestMapping annotation. This is equivalent to configure the class as a bean in beans.xml and
mapping there the url to that bean.
</p>
<p>
Since 1.1.5, @RequestMapping will also accept an array of strings, example:
</p>
<li>@RequestMapping(url={/xxx, /yyy, /zzz})</li>
<p>
In the case of http, the following components exist:
</p>
<ul>
  <li><u>HttpAction</u>: The HttpAction encapsulated the uri, the method used, and the arguments.</li>
  <li><u>HttpDispatcher</u>: Dispatches the request, using the mapper and the view resolver to render the view.
  The controller are mapped with both method and uri's. The action names, however, are invoked by convention. Suppose
  the uri /MyController/List, will mean that the controller that handles /MyController, needs to have a method
  named ListAction.</li>
  <li><u>HttpView</u>: Render the given view (a file in the filesystem), outputing headers and data.</li>
  <li><u>HttpViewResolver</u>: Maps a view name with a file in the filesystem. The root directory, an optional prefix and suffix can be
  configured.</li>
  <li><u>HttpUrlMapper</u>: Maps an uri and its method to a controller.</li>
  <li><u>HttpFrontController</u>: This is intended to be instantiated and called from your own entry point, will load the
  container and also, invoke the dispatcher and completely handle the request.</li>
  <li><u>HttpInterceptor</u>: This class can be extended, thus quickly creating pre and post dispatch interceptors.</li>
</ul>
<p>
A special setup is required in the web server. You need to forward ALL uri's (at least the ones you're interested
in manage with Ding) to your entry point, let's say index.php. In lighttpd you would do:<br/><br/>
url.rewrite-once = ( "^/(.*)" => "/index.php" )
</p>
<p>
And you're index.php would be something like this:
</p>
<p>
HttpFrontController::handle($properties, '/Some/Mapped/Path');<br/>
</p>
<p>
And that's it. Take a look at the example below to know how to actually configure the HttpViewResolver and HttpUrlMapper
in the container.
</p>
<H4>Http Example</H4>
<ul>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/mvc">docs/examples/mvc</a>: Using the xml and annotation provider.</li>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/mvc-twig">docs/examples/mvc-twig</a>: Using the xml and annotation providers, with twig as the template engine.</li>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/mvc-smarty">docs/examples/mvc-twig</a>: Using the xml and annotation providers, with smarty as the template engine.</li>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/mvc-interceptors">docs/examples/mvc-interceptors</a>: Pre and Post dispatch interceptors example.</li>
  </ul>
  <a href="#" class="next-link"><strong>Back</strong></a>

                  <a name="helper-syslog" id="helper-error"></a>
                  <div class="line">
                        <h3>9. The Syslog helper</h3>
                    <!-- <a href="#" class="next-link"><strong>Next</strong></a> -->
                  </div>
                  <div class="hr-1"><hr /></div>
                  <p>
This helper is designed to be a bean of scope singleton, and a facade for
using the syslog in unix environments.
 </p>
<H4>Class</H4>
<ul>
<li>Ding\Helpers\Syslog\SyslogHelper</li>
</ul>
<H4>Description</H4>
<p>
See the api and example for more details. You have to configure the known
syslog properties "ident", "options", and "facility".
</p>
<H4>Example</H4>
<ul>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/SyslogHelper">docs/examples/SyslogHelper</a>: Using the xml provider.</li>
</ul>
<a href="#" class="next-link"><strong>Back</strong></a>
                  <a name="helper-pami" id="helper-error"></a>
                  <div class="line">
                        <h3>10. The PAMI helper</h3>
                    <!-- <a href="#" class="next-link"><strong>Next</strong></a> -->
                  </div>
                  <div class="hr-1"><hr /></div>
                  <p>
This helper is designed to be a bean of scope singleton that uses the
<a href="https://marcelog.github.com/PAMI">PAMI framework</a> to let a listener of your
choice be called with any asterisk manager events.
 </p>
<H4>Class</H4>
<ul>
<li>Ding\Helpers\Pami\PamiHelper</li>
</ul>
<H4>Description</H4>
<p>
This bean has the properties "handler", "host", "port", "username", "password", "readTimeout", and "connectTimeout". Handler is a reference
to another bean that must implement <a href="https://github.com/marcelog/Ding/tree/master/src/mg/Ding/Helpers/Pami/IPamiEventHandler.php">Ding\Helpers\Pami\IPamiEventHandler. </a>
</p>
<H4>Example</H4>
<p>
See <a href="https://github.com/marcelog/AsterTrace">AsterTrace.</a>
</p>
<p>
Also, you might want to look at this <a href="http://marcelog.github.com/articles/php_asterisk_listener_example_using_pami_and_ding.html"> article</a>.
</p>
<ul>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/PAMI">docs/examples/PAMI</a>: Using the xml provider.</li>
</ul>
<a href="#" class="next-link"><strong>Back</strong></a>
                  <a name="helper-pagi" id="helper-error"></a>
                  <div class="line">
                        <h3>11. The PAGI helper</h3>
                    <!-- <a href="#" class="next-link"><strong>Next</strong></a> -->
                  </div>
                  <div class="hr-1"><hr /></div>
                  <p>
This helper is designed to be a bean of scope singleton that uses the
<a href="https://marcelog.github.com/PAGI">PAGI framework</a>, so you can construct
telephony applications.
 </p>
<H4>Class</H4>
<ul>
<li>Ding\Helpers\Pagi\PagiHelper</li>
</ul>
<H4>Example</H4>
<ul>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/PAGI">docs/examples/PAGI</a>: Using the xml provider.</li>
</ul>
</p>
<a href="#" class="next-link"><strong>Back</strong></a>
                  <a name="helper-tcpclient" id="helper-error"></a>
                  <div class="line">
                        <h3>12. The TCP Client helper</h3>
                    <!-- <a href="#" class="next-link"><strong>Next</strong></a> -->
                  </div>
                  <div class="hr-1"><hr /></div>
<H4>Class</H4>
<ul>
<li>Ding\Helpers\Tcp\TcpClientHelper</li>
</ul>
<H4>Description</H4>
<p>
This helper is intended to help you write tcp clients by just implementing
the <a href="https://github.com/marcelog/Ding/tree/master/src/mg/Ding/Helpers/Tcp/ITcpClientHandler.php">Ding\Helpers\Tcp\ITcpClientHandler</a> interface. You will need to implement the
following methods:
</p>
<ul>
  <li>connectTimeout(): Called when the connection has not been established in less
  than the configured milliseconds.</li>
  <li>readTimeout(): Called when the configured maximum read timeout has been
  reached with less than the configured minimum bytes to read.</li>
  <li>beforeConnect(): Called just before trying to connect to the server.</li>
  <li>connect(): Called when the connection has been established successfully.</li>
  <li>disconnect(): Called when either of the peers (you or the server) closes the connection.</li>
  <li>data(): Called when data is ready to be consumed from the server.</li>
</ul>
<p>
The helper itself has some useful method to control its behavior:
</p>
<ul>
  <li>open(): Opens the connection. You may optionally pass the ip address and port number to use to make the connection
  from. (i.e: 1.1.1.1:80 will try to make the connection FROM that address).</li>
  <li>read(): Reads data from the server (usually used from the data() method above).</li>
  <li>write(): Sends data to the server.</li>
  <li>close(): Closes the connection.</li>
  <li>process(): This is supposed to be called automatically if you declare(ticks=1). The helper
  uses register_tick_function() to achieve this. If you dont want to declare(ticks=1), you need
  to call this method from your own main loop. It will select() the socket, check for data
  available, control timeouts, etc.</li>
</ul>

<p>
See the php doc API for more details.
</p>
<H4>Example</H4>
<ul>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/TCPClientHelper">docs/examples/TCPClientHelper</a>: Using the xml provider.</li>
</ul>
<a href="#" class="next-link"><strong>Back</strong></a>
                  <a name="helper-tcpserver" id="helper-error"></a>
                  <div class="line">
                        <h3>13. The TCP Server helper</h3>
                    <!-- <a href="#" class="next-link"><strong>Next</strong></a> -->
                  </div>
                  <div class="hr-1"><hr /></div>
<H4>Class</H4>
<ul>
<li>Ding\Helpers\Tcp\TcpServerHelper</li>
<li>Ding\Helpers\Tcp\TcpPeer</li>
</ul>
<H4>Description</H4>
<p>
Use this helper to create one or more tcp server by just implementing the interface
<a href="https://github.com/marcelog/Ding/tree/master/src/mg/Ding/Helpers/Tcp/ITcpServerHandler.php">Ding\Helpers\Tcp\ITcpServerHandler</a>. You will need to implement the
following methods:
</p>
<ul>
  <li>beforeOpen(): Called right before opening the socket.</li>
  <li>beforeListen(): Called right before start listening in the socket for new connections.</li>
  <li>close(): Called right after the server socket has ben closed.</li>
  <li>handleConnection(): Called when a new connection has been established, will receive a TcpPeer as a client.</li>
  <li>handleData(): Called when a client has sent data, will receive a TCPPeer as the client.</li>
  <li>disconnect(): Called when a client disconnects, will receive a TCPPeer as the client.</li>
  <li>readTimeout(): Called when the read timeout has expired on a client, will receive a TcpPeer as a client.</li>
</ul>

<p>
The helper itself has some useful method to control its behavior:
</p>
<ul>
  <li>open(): Opens the server socket.</li>
  <li>close(): Closes the server socket.</li>
  <li>process(): This is supposed to be called automatically if you declare(ticks=1). The helper
  uses register_tick_function() to achieve this. If you dont want to declare(ticks=1), you need
  to call this method from your own main loop. It will select() the socket, check for data
  available, control timeouts, etc.</li>
</ul>
<p>
To control a peer, you can call these methods on the TcpPeer:
</p>
<ul>
<li>disconnect(): Disconnects the peer.</li>
<li>read(): Reads data from the peer.</li>
<li>write(): Writes data to the peer.</li>
</ul>

<H4>Example</H4>
<ul>
  <li><a href="https://github.com/marcelog/Ding/tree/master/docs/examples/TCPServerHelper">docs/examples/TCPServerHelper</a>: Using the xml provider.</li>
</ul>
<a href="#" class="next-link"><strong>Back</strong></a>
</div>
              </div>
              <span class="bottom"><span class="bl"></span><span class="br"></span></span>
            </div>
          </div>
          <div id="sidebar" class="highlight software-style">
            <div class="mod simple">
              <span class="top"><span class="tl"></span><span class="tr"></span></span>
              <div class="inner set-height-1">
<p>
If you liked this software (and feel generous), you can make a donation:
</p>
<p>
<a href='https://pledgie.com/campaigns/30947'><img alt='Click here to lend your support to: General and make a donation at pledgie.com !' src='https://pledgie.com/campaigns/30947.png?skin_name=chrome' border='0' ></a>
</p>
                <div class="google-ads">
                    <script type="text/javascript">
                    google_ad_client = "ca-pub-6947936742546167";
                    /* 9 */
                    google_ad_slot = "8617829895";
                    google_ad_width = 250;
                    google_ad_height = 250;
                    //-->
                    </script>
                    <script type="text/javascript"
                    src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
                    </script>
                </div>
                <h2>Software</h2>
                <div class="hr-1"><hr /></div>
                <ul class="simple-list">
                  <li><a href="/PAMI">PAMI</a></li>
                  <li><a href="/PAGI">PAGI</a></li>
                  <li><a href="/Nami">NAMI</a></li>
                  <li><a href="https://github.com/marcelog/erlagi">Erlagi</a></li>
                  <li><a href="https://github.com/marcelog/erlami">Erlami</a></li>
                  <li><a href="https://github.com/marcelog/SimplePcap">SimplePcap</a></li>
                  <li><a href="https://github.com/marcelog/MDM">MDM</a></li>
                  <li><a href="https://github.com/marcelog/Pakman">Pakman</a></li>
                  <li><a href="https://github.com/marcelog/AnoForPHP">AnoForPHP</a></li>
                </ul>
        <form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----MIIHNwYJKoZIhvcNAQcEoIIHKDCCByQCAQExggEwMIIBLAIBADCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwDQYJKoZIhvcNAQEBBQAEgYCyBY+gpYbb0AmAXULk8o9Gy9amLmyFL6bzHL+f0jVN2IZYvX5KfZs0ewfzRSXUdSEkL/YJ139PvROI7nvYjMxV2w4ENWuK3zlXVSHoe6KzugCakr+ncvREiq3xKFdWdQS+RxXrUuJD/kYAZsI25tBbb0507Rt4RABdTq/J3xSQgjELMAkGBSsOAwIaBQAwgbQGCSqGSIb3DQEHATAUBggqhkiG9w0DBwQISv+E8iGOkBOAgZBrBjuy61/jMOeCR/3adaHq6pby0+S+zTEv5/jfYEo+70cxK7WR6F4I6nSTDTCu0CvxzCAIYGoJDGRwXl8a1ts5Wy6XUiTMvDvdQU9yn6F5mO4IvN6oDoM4w8LX9KTEXaiG5keOxee4+Xm5/q6zU0HiIdtKLiQU2/AL1Xd+ulPZXDjKLxwxFjiSr7ep4HjGz62gggOHMIIDgzCCAuygAwIBAgIBADANBgkqhkiG9w0BAQUFADCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wHhcNMDQwMjEzMTAxMzE1WhcNMzUwMjEzMTAxMzE1WjCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMFHTt38RMxLXJyO2SmS+Ndl72T7oKJ4u4uw+6awntALWh03PewmIJuzbALScsTS4sZoS1fKciBGoh11gIfHzylvkdNe/hJl66/RGqrj5rFb08sAABNTzDTiqqNpJeBsYs/c2aiGozptX2RlnBktH+SUNpAajW724Nv2Wvhif6sFAgMBAAGjge4wgeswHQYDVR0OBBYEFJaffLvGbxe9WT9S1wob7BDWZJRrMIG7BgNVHSMEgbMwgbCAFJaffLvGbxe9WT9S1wob7BDWZJRroYGUpIGRMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbYIBADAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBQUAA4GBAIFfOlaagFrl71+jq6OKidbWFSE+Q4FqROvdgIONth+8kSK//Y/4ihuE4Ymvzn5ceE3S/iBSQQMjyvb+s2TWbQYDwcp129OPIbD9epdr4tJOUNiSojw7BHwYRiPh58S1xGlFgHFXwrEBb3dgNbMUa+u4qectsMAXpVHnD9wIyfmHMYIBmjCCAZYCAQEwgZQwgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tAgEAMAkGBSsOAwIaBQCgXTAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0xMTAzMTgxMzE0NTZaMCMGCSqGSIb3DQEJBDEWBBRbK+b8vrW2DKFa1PglwiL3RQTEHTANBgkqhkiG9w0BAQEFAASBgBv0m3e9vTpo2VicSxcwKB5fVTHGQltWg/IiAkyjY5Z0TlEBk6lRibDHm3fb4dG85FnLPtnfDIX4grX4uNDGStTyt8+OoEVKLE4dhAFZenvs3KdzY8BSRwVnUeHbxrbgGMfatOJ6gN+o9G178Cv6DZXWCd3020+CGxl/vXnQ4KAV-----END PKCS7-----
">
<input type="image" src="https://www.paypalobjects.com/WEBSCR-640-20110306-1/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/WEBSCR-640-20110306-1/en_US/i/scr/pixel.gif" width="1" height="1">
</form>
              </div>
              <span class="bottom"><span class="bl"></span><span class="br"></span></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="footer">
    <!-- <p>&copy; 2010 Marcelo G. All Rights Reserved. Website design by <a href="http://Digitallabs.tv" target="_blank">Digitallabs.tv</a></p> -->
    <address>Email: <a href="mailto:marcelog@gmail.com">marcelog@gmail.com</a></address>
  </div>
</div>

<!-- config SyntaxHighlighter -->
<script src='../dphighlighter/shCore.js' type='text/javascript'></script>
<script src='../dphighlighter/shBrushPhp.js' type='text/javascript'></script>
<script src='../dphighlighter/shBrushXml.js' type='text/javascript'></script>
<script src='../dphighlighter/shBrushJScript.js' type='text/javascript'></script>
<script src='../dphighlighter/shBrushCss.js' type='text/javascript'></script>
<script language="javascript">
    dp.SyntaxHighlighter.ClipboardSwf = '../dphighlighter/clipboard.swf';
    dp.SyntaxHighlighter.HighlightAll('code');
</script>
  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-21070993-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
