<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-6947936742546167",
          enable_page_level_ads: true
     });
</script>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script>

	<title>Ding: Configuring the container</title>

	<style type="text/css">
		body {
  		margin-top: 1.0em;
  		background-color: #f49648;
		  font-family: "Helvetica,Arial,FreeSans";
  		color: #000000;
    }
    #container {
      margin: 0 auto;
      width: 700px;
    }
		h1 { font-size: 3.8em; color: #0b69b7; margin-bottom: 3px; }
		h1 .small { font-size: 0.4em; }
		h1 a { text-decoration: none }
		h2 { font-size: 1.5em; color: #0b69b7; }
    h3 { color: #0b69b7; }
    a { color: #0b69b7; }
    .description { font-size: 1.2em; margin-bottom: 30px; margin-top: 30px; font-style: italic;}
    .download { float: right; }
		pre { background: #000; color: #fff; padding: 15px;}
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .footer { text-align:center; padding-top:30px; font-style: italic; }
	</style>

</head>

<body>

<H1><u>Configuring the container</u></H1>
See this section in the <a href="toc.html#config">new version of the site.</a><br/>

<g:plusone></g:plusone>
The container::getInstance() method accepts an array that is used to configure the
framework. <br/>
<center>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6947936742546167";
/* 5 */
google_ad_slot = "9067313223";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>

<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</center>
<center>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6947936742546167";
/* links1 */
google_ad_slot = "7432160740";
google_ad_width = 728;
google_ad_height = 15;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</center>
<pre>
$a = ContainerImpl::getInstance($properties);
</pre>
<H2>Logging</H2>
Use the optional property:
<pre>
$properties['ding']['log4php.properties'] => './log4php.properties'
</pre>

<H2>Bean Factory Drivers</H2>
You may configure any of the bean definition drivers available:
<ul>
  <li>xml: Parses the given XML file(s), usually beans.xml and get bean definitions from there. Requires the property 'filename'.</li>
  <li>yaml: Parses the given YAML file(s), usually beans.yaml and get bean definitions from there. Requires the property 'filename'.</li>
  <li>annotation: Extracts bean definitions and other information right from the annotated code. Requires the property 'scanDir'.</li>
</ul>
These drivers are configured with their own properties:
<p>
<ul>
  <li>$properties['ding']['factory']['bdef']['xml']</li>
  <li>$properties['ding']['factory']['bdef']['yaml']</li>
  <li>$properties['ding']['factory']['bdef']['annotation']</li>
</ul>
</p>
Example:
<pre>
$properties['ding']['factory']['bdef']['xml'] = array(
    'filename' => 'beans.xml'
)

$properties['ding']['factory']['bdef']['annotation'] = array(
    'scanDir' => array(realpath(__DIR__))
)
</pre>
<hr/>
<p>
You can also specify multiple files, for either xml or yaml drivers, like:
</p>
<pre>
$properties['ding']['factory']['bdef']['xml'] = array(
    'filename' => array('beans.xml', 'otherBeans.xml')
)

$properties['ding']['factory']['bdef']['yaml'] = array(
    'filename' => array('beans.yaml', 'otherBeans.yaml')
)
</pre>
<hr/>
<p>
You can also specify multiple search directories (paths), for either xml or yaml drivers, like:<br/>
</p>
<pre>
$properties['ding']['factory']['bdef']['yaml'] = array(
    'filename' => array('beans.yaml', 'otherBeans.yaml'), 'directories' => array('/etc/Ding', '/usr/local/etc/Ding')
)
</pre>
<hr/>
<p>
This will tell the yaml driver (you can also use it with the xml driver) to look for the bean
files beans.yaml and otherBeans.yaml in the directories specified. The order of the
directories is important, so the file used will be the first available one.
</p>
<center>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6947936742546167";
/* 5 */
google_ad_slot = "9067313223";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</center>
<center>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6947936742546167";
/* links1 */
google_ad_slot = "7432160740";
google_ad_width = 728;
google_ad_height = 15;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</center>
<H2>User properties</H2>
Use the optional property: $properties['ding']['properties'] to
specify any key/value pair that you may want search and replace via the PropertyFilter. Example:
<pre>
&lt;beans&gt;
    &lt;bean id="beanName" class="A\B\C" scope="prototype"&gt;
        &lt;property name="someProperty"&gt;
            &lt;value&gt;${some.value}&lt;/value&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<pre>
$properties['ding']['factory']['properties'] = array(
    'some.value' => 'This is the final property value'
)
</pre>
<p>
<b>NOTE:</b> If a property starts with "php.", like "php.date.timezone", ding will automatically
call ini_set() for that property, like: ini_set('date.timezone', value). See docs/examples/PhpProperties.
</p>
<p>
You can also configure the <b>PropertiesHolder</b> bean to inject properties files:
</p>
<pre>
&lt;beans&gt;
   &lt;bean id="PropertiesHolder" class="Ding\Helpers\Properties\PropertiesHelper" scope="singleton"&gt;
       &lt;property name="locations"&gt;
         &lt;array&gt;
           &lt;entry key="0"&gt;&lt;value&gt;resource://includepath://file.properties&lt;/value&gt;&lt;/entry&gt;
           &lt;entry key="1"&gt;&lt;value&gt;other.properties&lt;/value&gt;&lt;/entry&gt;
           &lt;entry key="2"&gt;&lt;value&gt;file://./user.properties&lt;/value&gt;&lt;/entry&gt;
           &lt;entry key="3"&gt;&lt;value&gt;file://./php.properties&lt;/value&gt;&lt;/entry&gt;
         &lt;/array&gt;
       &lt;/property&gt;
   &lt;/bean&gt;
   &lt;bean id="beanName" class="A\B\C" scope="prototype"&gt;
       &lt;property name="someProperty"&gt;
           &lt;value&gt;${some.value}&lt;/value&gt;
       &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<p>
So you can have your own properties and the ones that affect php behavior (i.e: "php." properties) in your
own separate config files.
</p>
<p>
Sample properties file:
</p>
<pre>
some.value=value
php.some.php.property=value
</pre>
<H2>Cache Subsystems</H2>
The cache subsystems use $properties['ding']['cache']. The subsystems are:

<ul>
  <li><u>autoloader</u>: In order to avoid resolving the ding's class names to
  a filesystem entry every time, a cache is used.</li>
  <li><u>proxy</u>: To cache proxy definitions: its expensive to create proxies
  because php lacks this hability, so we have to actually generate code. This code
  can be cached.</li>
  <li><u>annotations</u>: To cache annotations, its *really* expensive if you have
  a large source tree or use them a lot. So we cache the annotations for each class and
  the files and directories scanned (along with all autodiscovered classes there).</li>
  <li><u>bdef</u>: To cache BeanDefinitions so no xml's or annotations have to be
  reparsed per every request.</li>
  <li><u>beans</u>: To cache the beans themselves. This is actually not so easy as it
  sounds, so dont expect it to work as intended. Note: this is not a flaw of Ding itself but
  inherent to the architecture used generally in php, the lack of the concept of an
  application server, etc. It is recomended to use the dummy implementation for this cache.</li>
  <li><u>aspect</u>: To cache aspect and pointcut definitions (i.e: AspectManager).</li>
</ul>
<p>
The resulting properties needed to configure each one of the cache subsystems:
</p>
<center>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6947936742546167";
/* 5 */
google_ad_slot = "9067313223";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>

<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</center>
<center>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6947936742546167";
/* links1 */
google_ad_slot = "7432160740";
google_ad_width = 728;
google_ad_height = 15;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</center>
<p>
<ul>
  <li>$properties['ding']['cache']['autoloader']</li>
  <li>$properties['ding']['cache']['proxy']</li>
  <li>$properties['ding']['cache']['bdef']</li>
  <li>$properties['ding']['cache']['beans']</li>
  <li>$properties['ding']['cache']['aspect']</li>
  <li>$properties['ding']['cache']['annotations']</li>
</ul>
</p>
<p>
In turn, each one of these entries, require the 'impl' key to point to one
of the possible cache implementations:
<ul>
  <li><u>dummy</u>: Does not cache at all.</li>
  <li><u>file</u>: Uses the filesystem. Requires the additional option 'directory'.</li>
  <li><u>apc</u>: Uses apc.</li>
  <li><u>memcached</u>: Uses memcached php extension. Requires additional option 'memcached', an array with: 'host' and 'port'.</li>
  <li><u>zend</u>: Uses Zend_Cache. Requires additional option: 'zend' with an array of options of your choice according to Zend_Cache documentation.</li>
</ul>
</p>
<p>
Then, you can configure any of the cache subsystems with any of the cache implementations:<
</p>
<hr/>
<pre>
$properties['ding']['cache']['proxy'] = array(
    'impl' => 'file', 'directory' => '/tmp/Ding/cache'
)

$properties['ding']['cache']['bdef'] = array(
    'impl' => 'memcached', 'memcached' => array('host' => '127.0.0.1', 'port' => 11211)
)

$properties['ding']['cache']['proxy'] = array(
    'impl' => 'apc'
)

$properties['ding']['cache']['autoloader'] = array(
    'impl' => 'apc'
)

$properties['ding']['cache']['aspect'] = array(
    'impl' => 'apc'
)

$properties['ding']['cache']['annotations'] = array(
    'impl' => 'apc'
)

$properties['ding']['cache']['bdef'] = array(
    'impl' => 'dummy'
)
</pre>
<hr/>

<p>
<pre>
$zendCacheOptions = array(
    'frontend' => 'Core',
    'backend' => 'File',
    'backendoptions' => array('cache_dir' => '/tmp/Ding/zend/cache'),
    'frontendoptions' => array('lifetime' => 10000, 'automatic_serialization' => true)
);

$properties['ding']['cache']['bdef'] = array(
    'impl' => 'zend', 'zend' => $zendCacheOptions
)
</pre>
</p>
<hr/>
<H2>Driver properties</H2>
<p>
Some drivers are optional:
<ul>
  <li>SignalHandler</li>
  <li>ErrorHandler</li>
  <li>Shutdown</li>
  <li>Timezone</li>
</ul>
You can explicitely tell the container to use them with the following options:<br/>
<pre>
$options['drivers'] => array('signalhandler' => array())
$options['drivers'] => array('errorhandler' => array())
$options['drivers'] => array('shutdown' => array())
$options['drivers'] => array('timezone' => array())
</pre>
</p>
    <p>
        <form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
">
<input type="image" src="https://www.paypalobjects.com/WEBSCR-640-20110306-1/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/WEBSCR-640-20110306-1/en_US/i/scr/pixel.gif" width="1" height="1">
</form>
If you liked Ding (and have a generous soul, of course), please contribute so I can dedicate more of my spare time to it!
    </p>
    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-21070993-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>